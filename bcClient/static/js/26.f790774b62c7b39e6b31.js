webpackJsonp([26],{YhYs:function(t,e){},qG1m:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("mvHQ"),o=s.n(n);console.log("USER_PAGEFRIEND_ADDFRIEND_VUE");var a={data:function(){return{user:"",searchResult:[],total:0,page:0,pageNum:0,host:this.GLOBAL.Host}},watch:{user:function(){this.page=0,this.searchFriend()}},methods:{nextPage:function(){this.page<this.pageNum&&this.searchFriend()},searchFriend:function(){this.total=0,this.searchResult=[];var t={send_id:this.GLOBAL.userInfo.id,nickname:this.GLOBAL.userInfo.nickname,fname:this.user,msg:"I am finding friends!",type:"searchFriends",page:this.page,con_id:this.GLOBAL.connectionId},e=this;this.senddata({data:t,callback:function(t){e.searchResult=t.result.rearchResult,e.total=t.result.totalNum,e.pageNum=Math.ceil(e.total/t.result.listRows),e.page++,e.page==e.pageNum&&(e.pageNum=0)},handType:"user"})},tochat:function(t){var e=this;return t.stmessage?this.GLOBAL.userInfo.stmessage?(this.GLOBAL.friendInfo={info:{head:t.head,id:t.id,nickname:t.nickname,username:t.username,connectionID:t.connectionID,on_status:t.on_status},status:2},void this.$router.push("/chat")):(this.$messagebox.confirm("你设置了拒收陌生人消息，对方无法向你发送消息，是否现在是修改设置？").then(function(t){e.$router.push("/mySystem")}).catch(function(t){}),!1):(this.$messagebox.alert("对方设置了拒收陌生消息！"),!1)},addFriend:function(t,e){var s={send_id:this.GLOBAL.userInfo.id,get_id:t.id,status:3,content:"我想添加你为好友！",type:"addFriendRequest",con_id:this.GLOBAL.connectionId,fcon_id:t.connectionID},n=this;this.senddata({data:s,callback:function(e){if(console.log("<result>"),console.log(e),console.log("</result>"),e.msg)if(e.fInfo){n.$set(n.GLOBAL.friendLists.friends,e.fInfo.id,[]),n.setGlobalAttribute(n.GLOBAL.friendLists.friends[e.fInfo.id],e.fInfo),n.$set(n.GLOBAL.msgList,e.fInfo.id,[]),n.GLOBAL.msgList[e.fInfo.id].push(e.msg),n.GLOBAL.friendMsgNum[e.fInfo.id]?n.GLOBAL.friendMsgNum[e.fInfo.id]++:n.GLOBAL.friendMsgNum[e.fInfo.id]=1,n.$forceUpdate();var s={info:e.fInfo,status:1};n.setGlobalAttribute(n.GLOBAL.friendInfo,s),localStorage.setItem("bc_friendInfo",o()(s)),n.$router.push("/chat")}else t.status=3,n.$messagebox.alert(e.msg.content);else n.$messagebox.alert("请求发送失败！")},handType:"user"})}},beforeCreate:function(){console.log("addFriend->beforeCreate...")},created:function(){console.log("addFriend->created...")},beforeMount:function(){console.log("addFriend->beforeMount...")},mounted:function(){console.log("addFriend->mounted..."),this.$parent.tabbarShow=!1},beforeUpdate:function(){console.log("addFriend->beforeUpdate..."),this.$parent.tabbarShow=!1,this.checkLogin(),this.onmessage()},updated:function(){console.log("addFriend->updated..."),this.checkLogin(),this.onmessage(),document.getElementsByTagName("body")[0].className="bgc-fff"},beforeDestroy:function(){console.log("addFriend->beforeDestroy..."),document.body.removeAttribute("class","bgc-fff")},destroyed:function(){console.log("addFriend->destroyed...")}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("mt-header",{staticStyle:{height:"12vw",background:"white !important"},attrs:{fixed:"true"}},[s("router-link",{attrs:{slot:"left",to:"/friend"},slot:"left"},[s("mt-button",{staticStyle:{color:"#666"},attrs:{icon:"back"}})],1),t._v(" "),s("div",{staticClass:"textbox",attrs:{slot:"right"},slot:"right"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user,expression:"user"}],attrs:{type:"text",placeholder:"请输入好友手机号｜账号｜昵称"},domProps:{value:t.user},on:{input:function(e){e.target.composing||(t.user=e.target.value)}}})])],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.user,expression:"user"}],staticClass:"resultbox"},[s("div",{staticClass:"resultTitle"},[t._v("搜索结果（共"+t._s(t.total)+"条结果）\n      "),t.pageNum>1?s("button",{on:{click:t.nextPage}},[t._v("下一页")]):t._e()]),t._v(" "),s("div",{staticClass:"resultList"},t._l(t.searchResult,function(e,n){return s("div",{key:n,staticClass:"oneInfo"},[s("div",{staticClass:"headBox"},[s("img",{attrs:{src:t.host+e.head,alt:""}})]),t._v(" "),s("div",{staticClass:"infobox"},[s("div",[s("span",[t._v(t._s(e.username))]),t._v(" "),s("span",t._l(e.medals,function(e,n){return s("img",{key:n,attrs:{src:t.host+e,alt:""}})}))]),t._v(" "),s("div",[t._v("\n            ID:"+t._s(e.nickname)+"\n          ")])]),t._v(" "),s("div",{staticClass:"btnBox"},[3==e.status?s("button",{staticStyle:{background:"#ccc",border:"1px solid #ccc"}},[t._v("等待验证")]):s("button",{on:{click:function(s){t.addFriend(e,s)}}},[t._v("添加好友")]),t._v(" "),s("button",{on:{click:function(s){t.tochat(e)}}},[t._v("发送消息")])])])}))])],1)},staticRenderFns:[]};var r=s("VU/8")(a,i,!1,function(t){s("YhYs")},"data-v-a508a436",null);e.default=r.exports}});
//# sourceMappingURL=26.f790774b62c7b39e6b31.js.map