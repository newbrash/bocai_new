webpackJsonp([47],{KdNX:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("mvHQ"),a=s.n(o);console.log("USER_BANK_BANK_VUE");var n={data:function(){return{trading:!1,storage_gold:"",get_gold:"",tradingPsd:"",operation:""}},watch:{tradingPsd:function(){console.log(this.tradingPsd.length),this.tradingPsd.length>=6&&(this.tradingPsd=this.tradingPsd.slice(0,6),this.tradingPsd==this.GLOBAL.userInfo.trading?(1==this.operation?this.calculateStorage():this.calculateTakeout(),this.operation="",this.storage_gold="",this.tradingPsd="",this.trading=!1):(this.$messagebox.alert("交易密码不正确！"),this.tradingPsd=""))}},methods:{cancleTrading:function(){this.trading=!1,this.tradingPsd=""},operationStorage:function(){if(!this.storage_gold)return this.$messagebox.alert("请输入存储金币"),!1;this.trading=!0,this.operation=1,this.$nextTick(function(){document.getElementById("passwordbox").focus()})},calculateStorage:function(){if(this.storage_gold)if(this.storage_gold>this.GLOBAL.userInfo.gold)this.$messagebox.alert("当前金额不足以支付！");else{var t={type:"storageGold",gold:this.storage_gold,tradingPsd:this.tradingPsd,send_id:this.GLOBAL.userInfo.id,con_id:this.GLOBAL.connectionId},e=this;this.senddata({data:t,callback:function(t){console.log("<++++++++++++++++++++++++++++++++>"),console.log(t),console.log("<++++++++++++++++++++++++++++++++>"),t.status?(e.$messagebox.alert("存储成功！"),e.GLOBAL.userInfo.bank=t.goldInfo.bank,e.GLOBAL.userInfo.gold=t.goldInfo.gold,e.$forceUpdate(),localStorage.setItem("bc_userInfo",a()(e.GLOBAL.userInfo))):e.$messagebox.aelrt(t.msg)},handType:"user"})}else this.$messagebox.alert("请输入存放金额！")},operationTakeout:function(){if(!this.get_gold)return this.$messagebox.alert("请输入取出金币"),!1;this.operation=2,this.trading=!0,this.$nextTick(function(){document.getElementById("passwordbox").focus()})},calculateTakeout:function(){if(this.get_gold>this.GLOBAL.userInfo.bank)this.$messagebox.alert("银行金币不足！");else if(this.get_gold){var t={type:"getGoldFromBank",gold:this.get_gold,tradingPsd:this.tradingPsd,send_id:this.GLOBAL.userInfo.id,con_id:this.GLOBAL.connectionId},e=this;this.senddata({data:t,callback:function(t){console.log("《=================================》"),console.log(t),console.log("《=================================》"),t.status?(e.GLOBAL.userInfo.bank=t.goldInfo.bank,e.GLOBAL.userInfo.gold=t.goldInfo.gold,e.$messagebox.alert("成功取出金币："+e.get_gold+"个"),e.get_gold="",e.$forceUpdate(),localStorage.setItem("bc_userInfo",a()(e.GLOBAL.userInfo))):e.$messagebox.alert(t.msg)},handType:"user"})}else this.$messagebox.alert("请输入金币个数！")}},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){var t=this;this.$parent.tabbarShow=!1,this.$parent.tabbarWhic=!1,this.GLOBAL.userInfo.trading?(this.checkLogin(),this.onmessage()):this.$messagebox.confirm("您还没设置交易密码，现在去设置？").then(function(e){t.$router.push("/transPsd")}).catch(function(e){t.$router.push("/user")})},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{background:"#E7E7E7","min-height":"93vh"}},[s("mt-header",{staticStyle:{height:"10vw","font-size":"4vw",background:"#57D6DD"},attrs:{title:"社区银行",fixed:"true"}},[s("router-link",{attrs:{slot:"left",to:"/user"},slot:"left"},[s("mt-button",{staticClass:"BACKBTN",staticStyle:{height:"10vw"},attrs:{icon:"back"}},[t._v("返回")])],1)],1),t._v(" "),s("div",{staticClass:"pageContent bank"},[s("div",{staticClass:"mt10 bankMoney"},[t._v("\n      已存金币： "+t._s(this.GLOBAL.userInfo.bank)+"\n    ")]),t._v(" "),s("div",{staticClass:"mt10 option"},[s("div",{staticClass:"nowgold"},[s("span",[t._v("当前金币")]),t._v(" "),s("span",[t._v(t._s(this.GLOBAL.userInfo.gold))])])]),t._v(" "),s("div",{staticClass:"mt10 option bankbox"},[s("mt-field",{attrs:{type:"number",placeholder:"请输入金额",autocomplete:"off",disableClear:!0},model:{value:t.storage_gold,callback:function(e){t.storage_gold=e},expression:"storage_gold"}},[s("mt-button",{on:{click:t.operationStorage}},[t._v("存金币")])],1),t._v(" "),s("mt-field",{attrs:{type:"number",placeholder:"请输入金额",autocomplete:"off",disableClear:!0},model:{value:t.get_gold,callback:function(e){t.get_gold=e},expression:"get_gold"}},[s("mt-button",{on:{click:t.operationTakeout}},[t._v("取金币")])],1)],1)]),t._v(" "),s("section",{directives:[{name:"show",rawName:"v-show",value:t.trading,expression:"trading"}]},[s("div",{staticClass:"trading-bgbox"}),t._v(" "),s("div",{staticClass:"password-box"},[s("span",{on:{click:t.cancleTrading}},[t._v("X")]),t._v(" "),s("div",{staticClass:"tips-box"},[t._v("请输入交易密码")]),t._v(" "),s("div",{staticClass:"psd-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.tradingPsd,expression:"tradingPsd"}],attrs:{id:"passwordbox",type:"password"},domProps:{value:t.tradingPsd},on:{input:function(e){e.target.composing||(t.tradingPsd=e.target.value)}}})])])])],1)},staticRenderFns:[]};var r=s("VU/8")(n,i,!1,function(t){s("ZZlG")},"data-v-0a06b58d",null);e.default=r.exports},ZZlG:function(t,e){}});
//# sourceMappingURL=47.668b4768d086111ff848.js.map