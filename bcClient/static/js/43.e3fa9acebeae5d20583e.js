webpackJsonp([43],{"/p2a":function(t,i){},PLiX:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=s("mvHQ"),e=s.n(n),a={data:function(){return{gold:"",remark:"",trading:"",isTransing:!1}},mounted:function(){var t=this;console.log(this.GLOBAL.friendInfo),this.$parent.tabbarShow=!1,this.GLOBAL.friendInfo.info||this.$router.push("/friend"),this.checkLogin(),this.onmessage(),this.GLOBAL.userInfo.trading||this.$messagebox.confirm("您目前还没有设置交易密码，请前往“我的设置”设置交易密码").then(function(i){t.$router.push("/transPsd")}).catch(function(i){t.$router.push("/chat")})},methods:{transGold:function(){if(this.gold)if(this.gold>this.GLOBAL.userInfo.gold)this.$messagebox.alert("您当前的金币为："+this.GLOBAL.userInfo.gold+",不足以转账。");else{if(-1==this.gold.indexOf("."))this.gold+=".00";else this.gold.split(".")[1].length<2&&(this.gold+="0");this.isTransing=!0,this.$nextTick(function(){document.getElementById("tradding").focus()})}else this.$messagebox.alert("请输入转账金币！")},cancle:function(){this.isTransing=!1,this.trading=""}},watch:{gold:function(){var t=this.gold.match(/[0-9]+\.[0-9]{0,2}/);t&&(this.gold=t[0])},trading:function(){var t=this;if(/[^0-9]/.test(this.trading))this.$messagebox.alert("请输入六位数字的密码！").then(function(i){t.trading="",document.getElementById("tradding").focus()});else if(this.trading.length>=6)if(this.trading=this.trading.substr(0,6),this.trading==this.GLOBAL.userInfo.trading){var i={type:"transferAccounts",con_id:this.GLOBAL.connectionId,gold:this.gold,remark:this.remark?this.remark:"转账给"+this.GLOBAL.friendInfo.info.nickname,trading:this.trading,recive_id:this.GLOBAL.friendInfo.info.id,recive_name:this.GLOBAL.friendInfo.info.nickname,recive_connectionID:this.GLOBAL.friendInfo.info.connectionID,status:this.GLOBAL.friendInfo.status,send_id:this.GLOBAL.userInfo.id,send_name:this.GLOBAL.userInfo.nickname},s=this;this.senddata({data:i,callback:function(t){if(console.log(t),s.GLOBAL.userInfo.gold!=t.gold&&(s.GLOBAL.userInfo.gold=t.gold,localStorage.setItem("bc_userInfo",e()(s.GLOBAL.userInfo))),t.status){if(s.GLOBAL.msgList[s.GLOBAL.friendInfo.info.id])s.updateMsgList(t.msg.content);else{s.$set(s.GLOBAL.msgList,s.GLOBAL.friendInfo.info.id,{}),t.msg.send_status=!0;var n=[t.msg];s.setGlobalAttribute(s.GLOBAL.msgList[s.GLOBAL.friendInfo.info.id],n)}s.$router.push({path:"/transerfersuccess",query:{gold:i.gold,recive_user:i.recive_name}})}else this.$messagebox.alert(t.msg)},handType:"user"}),console.log("发送转账请求")}else this.$messagebox.alert("支付密码错误，请重试！").then(function(i){t.trading="",document.getElementById("tradding").focus()})}}},o={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",[s("mt-header",{attrs:{title:"转账",id:"transacountheader"}},[s("router-link",{attrs:{slot:"left",to:"/chat"},slot:"left"},[s("mt-button",{staticStyle:{color:"#666","font-size":"7vw","font-weight":"600"},attrs:{icon:"back"}})],1),t._v(" "),s("div",{staticStyle:{color:"#666","font-size":"4vw","font-weight":"600"},attrs:{slot:"right"},slot:"right"},[t._v("记录")])],1),t._v(" "),s("section",{staticClass:"backbox"},[s("div",{staticClass:"bodybox"},[s("div",{staticClass:"headbox"},[s("div",{staticClass:"head-img"},[s("img",{attrs:{src:this.GLOBAL.Host+this.GLOBAL.friendInfo.info.head,alt:""}})]),t._v(" "),s("p",[t._v(t._s(this.GLOBAL.friendInfo.info.nickname))])]),t._v(" "),s("div",{staticClass:"moneybox"},[s("p",[t._v("输入金额")]),t._v(" "),s("div",[s("span",[t._v("￥")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.gold,expression:"gold"}],attrs:{type:"number",placeholder:"0.00"},domProps:{value:t.gold},on:{input:function(i){i.target.composing||(t.gold=i.target.value)}}})])]),t._v(" "),s("div",{staticClass:"remarkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.remark,expression:"remark"}],attrs:{type:"text",placeholder:"转账备注（50字以内）"},domProps:{value:t.remark},on:{input:function(i){i.target.composing||(t.remark=i.target.value)}}})]),t._v(" "),s("div",{staticClass:"btnbox",on:{click:t.transGold}},[t._v("转账")])])]),t._v(" "),s("section",{directives:[{name:"show",rawName:"v-show",value:t.isTransing,expression:"isTransing"}]},[s("div",{staticClass:"bg-box"}),t._v(" "),s("div",{staticClass:"trading-box"},[s("div",{staticClass:"trading-inline-box trading-first-box"},[s("span",{staticClass:"trading-cancel-btn",on:{click:t.cancle}},[t._v("×")]),t._v(" "),t._m(0)]),t._v(" "),s("div",{staticClass:"trading-inline-box trading-second-box"},[s("div",{staticClass:"trading-inline-box user-head-box"},[s("img",{attrs:{src:this.GLOBAL.Host+this.GLOBAL.userInfo.head,alt:"头像"}})]),t._v(" "),s("span",[t._v("转账给“"+t._s(this.GLOBAL.friendInfo.info.nickname)+"”")])]),t._v(" "),s("div",{staticClass:"trading-inline-box trading-third-box"},[s("span",[t._v("￥")]),t._v(" "),s("span",[t._v(t._s(t.gold)+t._s(t.gold_prefix))])]),t._v(" "),t._m(1),t._v(" "),s("div",{staticClass:"trading-inline-box trading-fifth-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.trading,expression:"trading"}],attrs:{type:"password",id:"tradding"},domProps:{value:t.trading},on:{input:function(i){i.target.composing||(t.trading=i.target.value)}}})])])])],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("span",{staticClass:"trading-inline-box tranding-tips-box"},[i("span",[this._v("转账支付")]),this._v(" "),i("span",[this._v("忘记密码?")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"trading-inline-box trading-fourth-box"},[i("img",{attrs:{src:"static/64-金币.png",alt:"金币"}}),this._v(" "),i("div",{staticClass:"trading-inline-box gold-box"},[i("span",[this._v("金币")]),this._v(" "),i("img",{attrs:{src:"static/右箭头.png",alt:""}})])])}]};var r=s("VU/8")(a,o,!1,function(t){s("/p2a")},null,null);i.default=r.exports}});
//# sourceMappingURL=43.e3fa9acebeae5d20583e.js.map