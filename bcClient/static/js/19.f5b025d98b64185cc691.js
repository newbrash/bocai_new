webpackJsonp([19],{It8Q:function(t,e){},SaAd:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhGRDUyNDA3QTVEMzExRThCNzY5RUUwNUM4ODc4QUYxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhGRDUyNDA4QTVEMzExRThCNzY5RUUwNUM4ODc4QUYxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEZENTI0MDVBNUQzMTFFOEI3NjlFRTA1Qzg4NzhBRjEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEZENTI0MDZBNUQzMTFFOEI3NjlFRTA1Qzg4NzhBRjEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz63VQJIAAAFt0lEQVR42tRaS0xkRRS93TRfm+YrHREIgo1AgMkMDRJ2CiTAQom7+Sa6wOhKoyt/izFGExey0oSFE0ediRs1hk8CBLYIzKgJTKsIJoSQgICBHmk+AbznTRWpftP6qvv1dDMnual+1e9Vnfuq6ta9t57j+PiY7KK/v7+Ii2dYWliqWZ5geZTlEXHLPyx/sfzJ8ivLJMtEb2/vmt2+HbEqwKQLuLjCcoGlEW1F2QQ6vsVyg+U6K7OREAWY+GNcvMnysvKG7WKH5XOWD1mRlQeiABN3cfE6y3ssbvU/p9NJXq+XiouLqaCggHJycigrK4tcLhc5HA46ODignZ0d2traoo2NDVpZWaHV1VU6Ojoyd3OX5SpLHytyEDcFmLyPi29Yzqr1IFtTU0OVlZWUnp4e1Svf29ujhYUFCgQChlIm/MxykZW4Y1sBJv885iiLR9YVFhaS3++nsrKyuMyfpaUlmpqaos3NTfNoXGYlvo9ZASbfy8WnLCm4TklJoaamJqqvrzemRjyB6TQ7O0vT09N0eHgoq/HjVVaiP2oFmPwrgrwBj8dDHR0dxrR5kMAojIyM0Pb2tloNJT7TVoDJP8fFt/LNY8p0dXVRZmYmJQKhUIiGh4dpfX1dHYkXWIkfLBVg8jVcTElLU1RURN3d3ZSWlkaJxP7+Pg0NDdHa2pq6JppZiUCYBTSRT+XipiSPadPZ2Zlw8gD6RN/gIABONwXHyAowXmM5Ixdse3s7ZWRkULKAvsEBXATOiL3ofgVYs2KxSRmAtcHcTzbAobm5Wa16V3C9bwTeklMHlgam8rSgrq5OtX7g+HaYAqwRXvVLshIax9vO2/I4mYtpFF4UnMklKi6xZMohKy0ttdx0JicnaX5+3rj2+XzU0tJi+ES6m1a0z4MTuAnTmik49zkVBQzU1tZaEkDn2DXhz0Dwe2ZmRvuNxvq8idtFYwqJYOSctDwVFRWWDck3pwJOmS5ifR7cFIvUiMWMEXhWBiPYtJJh86PZG8BRLg1EgVDgaVkDf14HmLNmVFdXaxOx87yJo98lYtgT/14HWHDqVAAh7Bu6sPO8ieNTUOBJeYVISgewFq2trYbEAjvPmzj6MIW88ipR3qYdmDh6oUC2ukhOO0wcs530cGMfCgRVH/zUMw7nGIQCq2okdNph4vg3rNAf0hIhb5OXl2fZyPj4eKScjm2Hra2tzfI+cFQ3dZfIVXbiCvmZ8vJyy0aQlAoGg3EPXnRgyiH9hin0o7xCxkwH2dnZcZ8aOiMfgeMtKDBB9xKtRgCts5B1XY5ooNMmuClBPjiPOznKxyK+beQuDg9pcXHRsqGqqipt3193Z0abVgA3Jel1G4lgyeIrWTs3N2fZkNvt1oobdIG2dKalidsNNSaGAiG5SJCrtEJjY6Oa8ogZaANtWQGclAUMrtdPFOChQJx2Tf6LRKuVmUQ22m7OSOZ+rDLb4AJOCq4JzmFZiQ9E9svITyLMs0Jubi719PQYZbSI5llwUTLXdwXX8LSKOBm5Kq+RJVZyk5ZEGhoa1HDvP4F7cK8ueXAAFwXvq6c4LtP9fSznWc5itY+NjRkdWW0ymAoIUkAMhxbLy8vGG5PbPlzg/Px8KikpMQ5DcHqjg93dXYODYnl+YvkkbAePkNxFvIcUgUfGyclI7uJYanBwULX72Pr9/PZ/j5haVKYS4rzLdC+lbTSAhvA2EgX0NTAwoJIHl0tm8hFHQBmJpBxwwFSOjo7aO+BQlHh4j5gUJXq4+IKSc8h3hcl/979uuN1jVrgByJjFcswK3wYZuQjm+heWC3E5ZlWUgBnCCf07JBLBqjMW6aA7NTX1xKJoHnSHxCb1MZPXim9j+dTgcS7egMGi+H5qAFfmIya+HFUkZ+Njj0JhbpElPkexfewBN/5rli+lbxN1KBqnz22QHMPnNsiz4pRTfm7jVhak/NwmIKLACRGL2MK/AgwAhXiZFXDEROQAAAAASUVORK5CYII="},vpG7:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("fZjL"),n=s.n(i),a={data:function(){return{tips:"谈谈您的看法",themeDetail:{},themeInfo:{},host:this.GLOBAL.Host,imgHost:this.GLOBAL.logoHost+"themeImgs/",commentList:{},page:0,order:"desc",commentZanList:"",faces:["static/faces/分类.svg","static/faces/发呆.svg","static/faces/可爱.svg","static/faces/失败.svg","static/faces/大笑.svg","static/faces/板脸.svg","static/faces/白眼.svg","static/faces/笑口常开.svg","static/faces/等待.svg","static/faces/衰.svg","static/faces/调皮.svg","static/faces/难过.svg","static/faces/面无表情.svg","static/faces/鬼脸.svg"],isFace:!1,addImg:!1,imgType:"image/gif, image/jpeg, image/jpg, image/png",srchost:this.GLOBAL.logoHost+"commentImgs/",imgsrcs:[],reply_index:-1,reply_user:""}},watch:{},methods:{cancleReply:function(){this.reply_index=-1,this.tips="谈谈您的看法",this.reply_user=""},reply:function(t,e){this.tips="回复@"+t,this.reply_index=e,this.reply_user=t,document.getElementById("comment-content").focus()},cancleImg:function(t,e){this.imgsrcs.splice(e,1);var s=this.GLOBAL.Host+"/bcweb/index.php/Home/Uploads/unlinkFile";this.$axios.get(s,{params:{path:"/bcweb/public/commentImgs/"+t}}).then(function(t){console.log("++++++++++++++++respone++++++++++++++"),console.log(t.data),console.log("++++++++++++++respone++++++++++++++++")})},addImgToComment:function(){var t=event.target.files[0],e=t.type,s=t.size;if(-1==this.imgType.indexOf(e))return this.$messagebox.alert("请选择gif|jpeg|jpg|png格式的图片！"),!1;if(s>3145728)return this.$messagebox.alert("请选择3M以内的图片！"),!1;var i=this.GLOBAL.Host+"/bcweb/index.php/Home/Uploads/uploadCommentImg",n=new FormData;n.append("file",t,t.name);var a=this;this.$axios.post(i,n,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){console.log("++++++++++++++++respone++++++++++++++"),console.log(t.data),console.log("++++++++++++++respone++++++++++++++++"),console.log(t),console.log("+++++++++++++++respone+++++++++++++++"),t.status?(a.imgsrcs.push(t.data.src),document.getElementById("addImg").value=""):a.$messagebox.alert("上传失败！")}),console.log()},choseFace:function(t){var e=document.getElementById("comment-content");e.innerHTML+='<img style="width:5vw;height:5vw;display:inline;" src="'+t+'" />',this.isFace=!1,this.$nextTick(function(){if(console.log(e),console.log(window.getSelection),console.log(document.getSelection),window.getSelection){e.focus();var t=window.getSelection();t.selectAllChildren(e),t.collapseToEnd()}else if(document.selection){var s=document.selection.createRange();s.moveToElementText(e),s.collapse(!1),s.select()}else this.$messagebox.alert("当前设备不支持光标重定位，请手动点击");console.log(e.innerText.length),e.lastChild&&e.lastChild.scrollIntoView()})},zanComment:function(t,e){if(this.commentZanList&&-1!=this.commentZanList.indexOf(t.id+","))return this.$messagebox.alert("您已经点过赞了！"),!1;var s={type:"zanComment",comment_id:t.id,con_id:this.GLOBAL.connectionId,send_id:this.GLOBAL.userInfo.id},i=this;this.senddata({data:s,callback:function(e){console.log("responeZanComment"),console.log(e),console.log("responeZanComment"),e.status?(t.zan++,i.commentZanList+=t.id+",",localStorage.setItem("bc_comment_zans",i.commentZanList)):i.$messagebox.alert("点赞失败！")},handType:"user"})},checkZan:function(t,e){return this.commentZanList&&-1!=this.commentZanList.indexOf(t.id+",")?"static/点赞.png":"static/赞.png"},sendComment:function(){var t=document.getElementById("comment-content");if(!t.innerHTML)return this.$messagebox.alert("请输入你的评论！"),!1;if(console.log(t.innerHTML),this.reply_index<0){var e={type:"themeComment",post_id:this.themeDetail.id,content:t.innerHTML.replace(/"/g,""),send_id:this.GLOBAL.userInfo.id,nickname:this.GLOBAL.userInfo.nickname,con_id:this.GLOBAL.connectionId,imgs:this.imgsrcs},s=this;this.senddata({data:e,callback:function(i){if(i.status){var a=[{id:i.id,user_id:e.send_id,user_name:e.nickname,post_id:e.post_id,content:e.content,addtime:i.addtime,replys:[],head:s.GLOBAL.userInfo.head,zan:0,imgs:e.imgs}];s.imgsrcs=[],n()(s.commentList).length?s.commentList=a.concat(s.commentList):s.commentList=a,t.innerHTML="",console.log(s.commentList),s.$nextTick(function(){document.getElementById("comment-parent-box").firstChild.scrollIntoView()})}else s.$messagebox.alert(i.msg)},handType:"user"})}else{var i={user_id:this.GLOBAL.userInfo.id,user_name:this.GLOBAL.userInfo.nickname,comment_id:this.commentList[this.reply_index].id,content:t.innerHTML.replace(/"/g,""),reply_user:this.reply_user,type:"ReplyComment",con_id:this.GLOBAL.connectionId},a=this;this.senddata({data:i,callback:function(e){if(console.log(e),e.status){var s={id:e.id,user_id:i.user_id,user_name:i.user_name,comment_id:i.comment_id,content:i.content,reply_user:i.reply_user,addtime:e.addtime};a.commentList[a.reply_index].replys.push(s)}else e.msg?a.$messagebox.alert(e.msg):a.$messagebox.alert("请检查网络是否正常！");a.reply_index=-1,a.tips="谈谈您的看法",a.reply_user="",t.innerHTML=""},handType:"user"})}},showTime:function(t){return this.showDate(!1,t)},getComment:function(){var t={type:"getComment",post_id:this.$route.query.post_id,zone_id:this.$route.query.zone_id,page:this.page,order:this.order,send_id:this.GLOBAL.userInfo.id,con_id:this.GLOBAL.connectionId},e=this;this.senddata({data:t,callback:function(t){e.commentList=t.commentList,t.zoneInfo&&(e.themeInfo=t.zoneInfo),t.postInfo&&(e.themeDetail=t.postInfo)},callbackFlag:"resopneGetComment",handType:"user"})}},mounted:function(){this.$parent.tabbarShow=!1,localStorage.getItem("bc_comment_zans")&&(this.commentZanList=localStorage.getItem("bc_comment_zans"));var t=this;this.checkSocket(function(){t.getComment()}),this.onmessage()}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("mt-header",{staticStyle:{"border-bottom":".5vw solid #F2F2F2",color:"#999",background:"#ffffff"},attrs:{title:"帖子详情",fixed:""}},[i("router-link",{attrs:{slot:"left",to:this.$route.query.mytheme?{path:"/mytheme"}:{path:"/theme",query:{zone_id:this.$route.query.zone_id}}},slot:"left"},[i("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1)],1),t._v(" "),i("section",{staticClass:"theme-info-box"},[i("div",{staticClass:"user-info"},[i("div",{staticClass:"user-head"},[i("img",{attrs:{src:t.host+t.themeDetail.head,alt:""}})]),t._v(" "),i("div",{staticClass:"user-name-box"},[i("div",{staticClass:"user-name"},[t._v(t._s(t.themeDetail.user_name))]),t._v(" "),i("div",{staticClass:"theme-time"},[t._v(t._s(t.showTime(t.themeDetail.addtime)))])]),t._v(" "),i("div",{staticClass:"zone-img"},[i("img",{attrs:{src:t.host+t.themeInfo.img,alt:""}})])]),t._v(" "),i("div",{staticClass:"theme-info"},[i("div",{staticClass:"theme-title"},[t._v(t._s(t.themeDetail.title))]),t._v(" "),i("div",{staticClass:"theme-content",domProps:{innerHTML:t._s(t.themeDetail.content)}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.themeDetail.imgs,expression:"themeDetail.imgs"}],staticClass:"theme-imgs"},t._l(t.themeDetail.imgs,function(e,s){return i("img",{key:s,attrs:{src:t.imgHost+e,alt:""}})}))])]),t._v(" "),i("div",{staticClass:"box-border"}),t._v(" "),i("section",{staticClass:"comment-reply-box"},[t._m(0),t._v(" "),i("ul",{attrs:{id:"comment-parent-box"}},t._l(t.commentList,function(e,s){return i("li",{key:s,staticClass:"one-comment-box"},[i("div",{staticClass:"commentor-info"},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("div",{staticClass:"commentor-head"},[i("img",{attrs:{src:t.host+e.head,alt:""}})]),t._v(" "),i("div",{staticClass:"commentor-name-box"},[i("div",{staticClass:"commentor-name"},[t._v(t._s(e.user_name))]),t._v(" "),i("div",{staticClass:"comment-time"},[t._v(t._s(e.addtime))])])]),t._v(" "),i("div",{staticClass:"comment-zan"},[i("img",{attrs:{src:t.checkZan(e,s),alt:"点赞"},on:{click:function(i){t.zanComment(e,s)}}}),t._v(" "),i("span",[t._v(t._s(e.zan))])])]),t._v(" "),i("div",[i("div",{staticClass:"comment-content"},[i("span",{staticStyle:{"max-width":"90%"},domProps:{innerHTML:t._s(e.content)}}),t._v(" "),i("span",{staticClass:"reply-btn",on:{click:function(i){t.reply(e.user_name,s)}}},[t._v("回复")])]),t._v(" "),e.imgs?i("div",{staticClass:"comment-imgs"},t._l(e.imgs,function(e,s){return i("img",{key:s,attrs:{src:t.srchost+e,alt:""}})})):t._e(),t._v(" "),Object.keys(e.replys).length?i("div",{staticClass:"comment-replys"},t._l(e.replys,function(e,n){return i("div",{key:n,staticClass:"one-comment-reply"},[i("span",[i("span",{staticClass:"reply-object",on:{click:function(i){t.reply(e.user_name,s)}}},[t._v("“"+t._s(e.user_name)+"”")]),t._v("回复"),i("span",{staticClass:"reply-object",on:{click:function(i){t.reply(e.reply_user,s)}}},[t._v("“"+t._s(e.reply_user)+"”")]),t._v("：")]),t._v(" "),i("span",{domProps:{innerHTML:t._s(e.content)}})])})):t._e()])])})),t._v(" "),i("div",{staticClass:"talk-about-your-advice-box"},[i("div",{staticClass:"talk-about-your-advice"},[i("div",{staticClass:"talk-about-content"},[i("div",{staticClass:"send-content-box"},[i("div",{staticClass:"input-box",attrs:{contenteditable:"true",placeholder:t.tips,type:"text",id:"comment-content"}})]),t._v(" "),i("button",{on:{click:t.sendComment}},[t._v("发送")])]),t._v(" "),i("div",{staticClass:"talk-other-box"},[i("img",{attrs:{src:s("SaAd"),alt:""},on:{click:function(e){t.isFace=!0}}}),t._v(" "),t.reply_index<0?i("img",{attrs:{src:"static/截图.png",alt:""},on:{click:function(e){t.addImg=!0}}}):t._e(),t._v(" "),t.reply_index<0?i("input",{staticStyle:{opacity:"0","margin-left":"-6vw",width:"6vw",height:"6vw","border-radius":"6vw",overfllow:"hidden"},attrs:{type:"file",id:"addImg"},on:{change:t.addImgToComment}}):t._e(),t._v(" "),t.reply_index>=0?i("button",{staticStyle:{border:".5vw solid #ccc","font-size":"4vw","margin-left":"2vw",color:"#666"},on:{click:t.cancleReply}},[t._v("取消")]):t._e()])]),t._v(" "),i("transition",{staticClass:"faces-box",attrs:{name:"facesBao"}},[i("ul",{directives:[{name:"show",rawName:"v-show",value:t.isFace,expression:"isFace"}],staticClass:"faces-box"},[i("div",{staticStyle:{display:"block",width:"100%","text-align":"left"}},[i("span",{staticStyle:{display:"inline-block",width:"4vw",height:"4vw",background:"red","border-radius":"4vw","font-size":"4vw","text-align":"center","line-height":"4vw",color:"white"},on:{click:function(e){t.isFace=!1}}},[t._v("x")])]),t._v(" "),t._l(t.faces,function(e,s){return i("li",{key:s},[i("img",{attrs:{src:e,alt:""},on:{click:function(s){t.choseFace(e)}}})])})],2)]),t._v(" "),Object.keys(t.imgsrcs).length?i("div",{staticClass:"upload-img"},t._l(t.imgsrcs,function(e,s){return i("div",{key:s,staticStyle:{position:"relative"}},[i("span",{on:{click:function(i){t.cancleImg(e,s)}}},[t._v("x")]),t._v(" "),i("img",{attrs:{src:t.srchost+e,alt:""}})])})):t._e()],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h3",[this._v("查看全部评论"),e("img",{attrs:{src:"static/右箭头.png",alt:""}})])}]};var c=s("VU/8")(a,o,!1,function(t){s("It8Q")},null,null);e.default=c.exports}});
//# sourceMappingURL=19.f5b025d98b64185cc691.js.map