webpackJsonp([13],{IpWi:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAIAAACzY+a1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkEwQ0IyRTg5QTVEMzExRThBMUQyRTJENzE0MkM1MzhDIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkEwQ0IyRThBQTVEMzExRThBMUQyRTJENzE0MkM1MzhDIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTBDQjJFODdBNUQzMTFFOEExRDJFMkQ3MTQyQzUzOEMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTBDQjJFODhBNUQzMTFFOEExRDJFMkQ3MTQyQzUzOEMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7wDVWYAAAB+0lEQVR42uzdTWrDQBBEYdvkRrqOjqfjSGdSIAIj/ENgNqVuvrdKQKspqqf1QPi+ruvtE9M0Pf/ets0zl33mcUNx7vu+O4XSaGH9CLc/HIQWIsaPI6jLMT610CCFCCFCEaL6Rnr2b9BCBOBItRDxCDlSLUR6I3UEdeFIDVKIECKECHtspBypFiIMR6qFiEfIkWoh0hupI6gLR2qQQoQQIUTYYyPlSLUQYThSLUQ8Qo5UC5HeSB1BXThSLbw8y7Kc/53n2V0IEUKE+HAXcqRaCBspRjkmqBbWH6QcqbsQ7kKMwpEapBAhRAgR9thIOVIthPdCjMKRdhmkHKm7EO5CjMKRGqQQIUQIEfbYSDnS6lziQ+2X71cKkf3U5nip8F5YGI60yzrDkdpIkd5IGy8F7b/y5UgNUogQIoQIe2ykHKkWwnshRuFIuwxSjtRdCHchRuFIDVKIECKECHtspBypFsJ7IUbhSLsMUo7UXQh3IUbhSA1SiBDuwn/o+lNpWtiuhRypFiKM37XXQsQj5Ei1EN4LMQpHapBChBAhRNhjI+VItRBhOFItRDxCjlQLkd5IHUFdOFKDFCKECCHCHhspR6qFCMORaiHiEXKkWoj0RuoI6sKRGqQQIUQIEfbYSDlSLUQYjlQLEb8L3wXp+Xb8pk89c51ntLA8vwIMAMuJ10eYW6WXAAAAAElFTkSuQmCC"},SaAd:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhGRDUyNDA3QTVEMzExRThCNzY5RUUwNUM4ODc4QUYxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhGRDUyNDA4QTVEMzExRThCNzY5RUUwNUM4ODc4QUYxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEZENTI0MDVBNUQzMTFFOEI3NjlFRTA1Qzg4NzhBRjEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEZENTI0MDZBNUQzMTFFOEI3NjlFRTA1Qzg4NzhBRjEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz63VQJIAAAFt0lEQVR42tRaS0xkRRS93TRfm+YrHREIgo1AgMkMDRJ2CiTAQom7+Sa6wOhKoyt/izFGExey0oSFE0ediRs1hk8CBLYIzKgJTKsIJoSQgICBHmk+AbznTRWpftP6qvv1dDMnual+1e9Vnfuq6ta9t57j+PiY7KK/v7+Ii2dYWliqWZ5geZTlEXHLPyx/sfzJ8ivLJMtEb2/vmt2+HbEqwKQLuLjCcoGlEW1F2QQ6vsVyg+U6K7OREAWY+GNcvMnysvKG7WKH5XOWD1mRlQeiABN3cfE6y3ssbvU/p9NJXq+XiouLqaCggHJycigrK4tcLhc5HA46ODignZ0d2traoo2NDVpZWaHV1VU6Ojoyd3OX5SpLHytyEDcFmLyPi29Yzqr1IFtTU0OVlZWUnp4e1Svf29ujhYUFCgQChlIm/MxykZW4Y1sBJv885iiLR9YVFhaS3++nsrKyuMyfpaUlmpqaos3NTfNoXGYlvo9ZASbfy8WnLCm4TklJoaamJqqvrzemRjyB6TQ7O0vT09N0eHgoq/HjVVaiP2oFmPwrgrwBj8dDHR0dxrR5kMAojIyM0Pb2tloNJT7TVoDJP8fFt/LNY8p0dXVRZmYmJQKhUIiGh4dpfX1dHYkXWIkfLBVg8jVcTElLU1RURN3d3ZSWlkaJxP7+Pg0NDdHa2pq6JppZiUCYBTSRT+XipiSPadPZ2Zlw8gD6RN/gIABONwXHyAowXmM5Ixdse3s7ZWRkULKAvsEBXATOiL3ofgVYs2KxSRmAtcHcTzbAobm5Wa16V3C9bwTeklMHlgam8rSgrq5OtX7g+HaYAqwRXvVLshIax9vO2/I4mYtpFF4UnMklKi6xZMohKy0ttdx0JicnaX5+3rj2+XzU0tJi+ES6m1a0z4MTuAnTmik49zkVBQzU1tZaEkDn2DXhz0Dwe2ZmRvuNxvq8idtFYwqJYOSctDwVFRWWDck3pwJOmS5ifR7cFIvUiMWMEXhWBiPYtJJh86PZG8BRLg1EgVDgaVkDf14HmLNmVFdXaxOx87yJo98lYtgT/14HWHDqVAAh7Bu6sPO8ieNTUOBJeYVISgewFq2trYbEAjvPmzj6MIW88ipR3qYdmDh6oUC2ukhOO0wcs530cGMfCgRVH/zUMw7nGIQCq2okdNph4vg3rNAf0hIhb5OXl2fZyPj4eKScjm2Hra2tzfI+cFQ3dZfIVXbiCvmZ8vJyy0aQlAoGg3EPXnRgyiH9hin0o7xCxkwH2dnZcZ8aOiMfgeMtKDBB9xKtRgCts5B1XY5ooNMmuClBPjiPOznKxyK+beQuDg9pcXHRsqGqqipt3193Z0abVgA3Jel1G4lgyeIrWTs3N2fZkNvt1oobdIG2dKalidsNNSaGAiG5SJCrtEJjY6Oa8ogZaANtWQGclAUMrtdPFOChQJx2Tf6LRKuVmUQ22m7OSOZ+rDLb4AJOCq4JzmFZiQ9E9svITyLMs0Jubi719PQYZbSI5llwUTLXdwXX8LSKOBm5Kq+RJVZyk5ZEGhoa1HDvP4F7cK8ueXAAFwXvq6c4LtP9fSznWc5itY+NjRkdWW0ymAoIUkAMhxbLy8vGG5PbPlzg/Px8KikpMQ5DcHqjg93dXYODYnl+YvkkbAePkNxFvIcUgUfGyclI7uJYanBwULX72Pr9/PZ/j5haVKYS4rzLdC+lbTSAhvA2EgX0NTAwoJIHl0tm8hFHQBmJpBxwwFSOjo7aO+BQlHh4j5gUJXq4+IKSc8h3hcl/979uuN1jVrgByJjFcswK3wYZuQjm+heWC3E5ZlWUgBnCCf07JBLBqjMW6aA7NTX1xKJoHnSHxCb1MZPXim9j+dTgcS7egMGi+H5qAFfmIya+HFUkZ+Njj0JhbpElPkexfewBN/5rli+lbxN1KBqnz22QHMPnNsiz4pRTfm7jVhak/NwmIKLACRGL2MK/AgwAhXiZFXDEROQAAAAASUVORK5CYII="},ZySp:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={data:function(){return{title:"",srchost:this.GLOBAL.logoHost+"themeImgs/",imgs:[],isFace:!1,faceList:["static/faces/分类.svg","static/faces/发呆.svg","static/faces/可爱.svg","static/faces/大笑.svg","static/faces/失败.svg","static/faces/板脸.svg","static/faces/白眼.svg","static/faces/笑口常开.svg","static/faces/等待.svg","static/faces/衰.svg","static/faces/调皮.svg","static/faces/难过.svg","static/faces/面无表情.svg","static/faces/鬼脸.svg"],imgType:"image/jpg, image/jpeg, image/png, image/gif",beforeLenght:0,afterLength:0,beforeContent:"",afterContent:"",afterImgs:[]}},mounted:function(){this.$parent.tabbarShow=!1,this.checkSocket(),this.onmessage()},watch:{afterContent:function(){this.afterDel()}},methods:{beforeDel:function(){var t=event||window.event;t.keyCode||t.which;this.beforeContent=document.getElementById("postText").innerHTML,this.beforeLenght=this.beforeContent.length,this.afterContent=this.beforeContent},getContent:function(){this.afterContent=document.getElementById("postText").innerHTML},afterDel:function(){if(this.afterLength=this.afterContent.length,this.beforeLenght-this.afterLength>=3){var t=/<img.*?src="(.*?)".*?>/gm,e=this.beforeContent.match(t);if(this.afterImgs=this.afterContent.match(t),e)for(var i=new RegExp(/src="(.*?)"/),s=new RegExp(/src="static\/faces\/.*?"/),n=0;n<e.length;n++)if(!s.test(e[n])&&-1==this.inArray(e[n])){var a=i.exec(e[n]);this.delImg(a[1])}}},inArray:function(t){if(this.afterImgs&&this.afterImgs.length)for(var e=0;e<this.afterImgs.length;e++)if(this.afterImgs[e]==t)return e;return-1},delImg:function(t,e){t=t.replace(this.GLOBAL.Host,""),e>=0&&this.imgs.splice(e,1);var i=this.GLOBAL.Host+"/bcweb/index.php/Home/Uploads/unlinkFile";this.$axios.get(i,{params:{path:t}}).then(function(t){})},insertImg:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=event.target.files[0],s=i.type,n=i.size;if(-1==this.imgType.indexOf(s))return this.$messagebox.alert("请选择格式为：jpg|jpeg|png|gif的图片"),!1;if(n>3145728)return this.$messagebox.alert("照片不可以超过3M"),!1;var a=this.GLOBAL.Host+"/bcweb/index.php/Home/Uploads/uploadThemeImg",o=new FormData;o.append("file",i,i.name);var c=this;this.$axios.post(a,o,{headers:{"Content-Type":"multipart/form-data"}}).then(function(i){e?i.status?t.imgs.push(i.data.saveName):c.$messagebox.alert("上传失败！"):i.status?c.insertContent('<img style="max-width:100%;display:inline-block;" src="'+c.GLOBAL.Host+i.data.src+'" />'):c.$messagebox.alert("上传失败！"),t.$refs.pathClear1.value="",t.$refs.pathClear2.value=""})},addFace:function(t){this.insertContent('<img style="display:inline;width:6vw;height:6vw;margin:0px .5vw;" src="'+t+'" />'),this.isFace=!this.isFace},saveRange:function(){var t=window.getSelection?window.getSelection():document.selection;return!t.rangeCount||"postText"!=t.focusNode.id&&"postText"!=t.focusNode.parentNode.id&&"postText"!=t.focusNode.parentNode.parentNode.id?(this.$messagebox.alert("插入位置不在编辑区中！"),!1):t.createRange?t.createRange():t.getRangeAt(0)},insertContent:function(t){var e,i=this.saveRange();if(!i)return!1;if(window.getSelection){e=window.getSelection?window.getSelection():document.selection,i.collapse(!1);for(var s=i.createContextualFragment(t),n=s.lastChild;n&&"br"==n.nodeName.toLowerCase()&&n.previousSibling&&"br"==n.previousSibling.nodeName.toLowerCase();){var a=n;n=n.previousSibling,s.removeChild(a)}i.insertNode(s),n&&(i.setEndAfter(n),i.setStartAfter(n)),e.removeAllRanges(),e.addRange(i)}else i.pasteHTML(t),i.collapse(!1),i.select();this.afterContent=document.getElementById("postText").innerHTML},postTheme:function(){if(!this.title)return this.$messagebox.alert("请输入标题！"),!1;if(!document.getElementById("postText").innerHTML)return this.$messagebox.alert("请输入帖子内容！"),!1;if(!this.$route.query.zone_id)return this.$messagebox.alert("数据丢失，请重新进入发帖页面！"),!1;var t={type:"postTheme",zone_id:this.$route.query.zone_id,title:this.title,content:document.getElementById("postText").innerHTML.replace(/"/g,""),imgs:this.imgs,user_id:this.GLOBAL.userInfo.id,user_name:this.GLOBAL.userInfo.nickname,con_id:this.GLOBAL.connectionId},e=this;this.senddata({data:t,callback:function(t){t.status?e.$router.push({path:"/theme",query:{themeInfo:e.$route.query.themeInfo,zone_id:e.$route.query.zone_id}}):e.$messagebox.alert(t.msg)},handType:"user"})}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("mt-header",{staticStyle:{background:"#57D6DD"},attrs:{title:"发布帖子"}},[s("router-link",{attrs:{slot:"left",to:{path:"/theme",query:{zone_id:this.$route.query.zone_id}}},slot:"left"},[s("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1),t._v(" "),s("mt-button",{attrs:{slot:"right"},on:{click:t.postTheme},slot:"right"},[t._v("发布")])],1),t._v(" "),s("div",{staticClass:"pageContent"},[s("div",{staticClass:"post"},[s("div",{staticClass:"title"},[s("mt-field",{attrs:{placeholder:"请输入主题..."},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),t._v(" "),s("div",{staticClass:"postContent"},[s("div",{staticClass:"extend"},[s("img",{attrs:{src:i("SaAd")},on:{click:function(e){t.isFace=!t.isFace}}}),t._v(" "),s("img",{attrs:{src:"static/截图.png"}}),t._v(" "),s("input",{ref:"pathClear1",staticStyle:{height:"7vw",width:"7vw",overflow:"hidden","margin-left":"-12vw",opacity:"0"},attrs:{id:"insert-img-input-box",type:"file"},on:{change:function(e){t.insertImg(!1)}}})]),t._v(" "),t.isFace?s("div",{staticClass:"faces"},t._l(t.faceList,function(e,i){return s("img",{key:i,attrs:{src:e,alt:""},on:{click:function(i){t.addFace(e)}}})})):t._e(),t._v(" "),s("div",{staticClass:"text"},[s("div",{attrs:{contenteditable:"true",id:"postText",placeholder:"请输入内容",rows:"10"},on:{input:function(e){t.afterContent=e.target.innerHTML},keydown:t.beforeDel,keyup:t.getContent}})]),t._v(" "),s("div",{staticClass:"image"},[t._l(t.imgs,function(e,i){return s("div",{key:i,staticClass:"oneImgs"},[s("img",{attrs:{src:t.srchost+e,alt:""}}),t._v(" "),s("span",{on:{click:function(s){t.delImg(t.srchost+e,i)}}},[t._v("x")])])}),t._v(" "),s("div",{staticClass:"preview",staticStyle:{position:"relative"}},[s("img",{attrs:{src:i("IpWi")}}),t._v(" "),s("input",{ref:"pathClear2",staticStyle:{position:"absolute",top:"0px",left:"0px",width:"28vw",height:"28vw",border:"0px solid red",opacity:"0"},attrs:{type:"file",id:"add-img-input-box"},on:{change:function(e){t.insertImg(!0)}}})])],2)])])])],1)},staticRenderFns:[]};var a=i("VU/8")(s,n,!1,function(t){i("rihB")},"data-v-4844b457",null);e.default=a.exports},rihB:function(t,e){}});
//# sourceMappingURL=13.f79ce46760b44998192e.js.map