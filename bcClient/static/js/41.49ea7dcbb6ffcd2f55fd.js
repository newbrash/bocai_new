webpackJsonp([41],{BApA:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t("mvHQ"),i=t.n(a);console.log("USER_MYSYSTEM_PERSONAL_VUE");var n={data:function(){return{disableClear:!1,nickname:this.GLOBAL.userInfo.nickname,signature:this.GLOBAL.userInfo.signature,originalPsd:"",newPsd1:"",newPsd2:"",oriActive:!1,newActive:!1,imgData:{accept:"image/gif, image/jpeg, image/jpg, image/png"}}},watch:{originalPsd:function(){}},methods:{psdVerify:function(){if(this.originalPsd!=this.GLOBAL.userInfo.password)this.oriActive=!0,this.newActive=!1;else if(this.newPsd1!=this.newPsd2)this.newActive=!0,this.oriActive=!1;else{this.oriActive=!1,this.newActive=!1;var e={type:"changeLoginPassword",signature:"",originalPsd:this.originalPsd,newPsd1:this.newPsd1,newPsd2:this.newPsd2,send_id:this.GLOBAL.userInfo.id,con_id:this.GLOBAL.connectionId};this.newPsd1="",this.newPsd2="",this.originalPsd="";var s=this;this.senddata({data:e,callback:function(t){console.log("(******************************)"),console.log(t),console.log("(******************************)"),t.status?(s.$messagebox.alert("修改成功！"),s.GLOBAL.userInfo.password=e.newPsd1,localStorage.setItem("bc_userInfo",i()(s.GLOBAL.userInfo))):t.msg?s.$messagebox.alert(t.msg):s.$messagebox.alert("修改失败，请检查网络是否正常！")},handType:"user"})}},previewPic:function(e){var s=e.target.files[0],t=s.type,a=s.size;if(-1==this.imgData.accept.indexOf(t))return this.$messagebox.alert("请选择gif|jpeg|jpg|png格式的图片！"),!1;if(a>3145728)return this.$messagebox.alert("请选择3M以内的图片！"),!1;var n=this.GLOBAL.Host+"/bcweb/index.php/Home/Uploads/uploadHead",o=new FormData;o.append("file",s,s.name),o.append("uid",this.GLOBAL.userInfo.id);var r=this;this.$axios.post(n,o,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){console.log("++++++++++++++++++++++++++++++"),console.log("++++++++++++++++++++++++++++++"),console.log(e.data),console.log("++++++++++++++++++++++++++++++"),console.log("++++++++++++++++++++++++++++++"),console.log(e),e.data.status?(r.GLOBAL.userInfo.head=e.data.head,r.$forceUpdate(),localStorage.setItem("bc_userInfo",i()(r.GLOBAL.userInfo))):"null"!=e.data.msg?r.$messagebox.alert(e.data.msg):r.$messagebox.alert("图像不能为空！")})},changeUsername:function(){if(this.nickname)if(this.nickname==this.GLOBAL.userInfo.nickname)this.$messagebox.alert("新昵称不可以和旧昵称相同！");else{var e={type:"changeNickName",newname:this.nickname,signature:"",send_id:this.GLOBAL.userInfo.id,con_id:this.GLOBAL.connectionId},s=this;this.senddata({data:e,callback:function(e){console.log(e),e.status?(s.GLOBAL.userInfo.nickname=s.nickname,localStorage.setItem("bc_userInfo",i()(s.GLOBAL.userInfo)),s.$messagebox.alert("修改成功！")):(s.nickname=s.GLOBAL.userInfo.nickname,e.msg?s.$messagebox.alert(e.msg):s.$messagebox.alert("修改失败，请检查网络是否正常！"))},handType:"user"})}else this.$messagebox.alert("请输入昵称！")},changeSign:function(){if(this.signature)if(this.signature==this.GLOBAL.userInfo.signature)this.$messagebox.alert("签名还没有发生变化哦！");else{var e={type:"changeSignature",newsignature:this.signature,signatureStr:"",send_id:this.GLOBAL.userInfo.id,con_id:this.GLOBAL.connectionId},s=this;this.senddata({data:e,callback:function(e){console.log("<+++++++++++++++++++>"),console.log(e),console.log("<+++++++++++++++++++>"),e.status?(s.$messagebox.alert("修改成功！"),s.GLOBAL.userInfo.signature=s.signature,localStorage.setItem("bc_userInfo",i()(s.GLOBAL.userInfo))):(s.signature=s.GLOBAL.userInfo.signature,e.msg?s.$messagebox.alert(e.msg):s.$messagebox.alert("修改失败，请检查网络是否正常！"))},handType:"user"})}else this.$messagebox.alert("请输入签名...")}},beforeCreate:function(){},mounted:function(){this.checkLogin(),this.onmessage(),this.$parent.tabbarShow=!1,this.$parent.tabbarWhic=!1},beforeDestroy:function(){}},o={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("mt-header",{staticStyle:{background:"#57D6DD"},attrs:{title:"个人资料"}},[t("router-link",{attrs:{slot:"left",to:"/mySystem"},slot:"left"},[t("mt-button",{attrs:{icon:"back"}},[e._v("返回")])],1)],1),e._v(" "),t("div",{staticClass:"pageContent personal"},[t("div",{staticClass:"purikura"},[t("div",{staticClass:"purimg"},[t("img",{attrs:{id:"purpic",src:this.GLOBAL.Host+this.GLOBAL.userInfo.head}})]),e._v(" "),t("div",{staticClass:"uppurBtn"},[t("input",{staticStyle:{opacity:"0",position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},attrs:{id:"uppic",type:"file"},on:{change:e.previewPic}}),e._v(" "),t("i",{staticClass:"iconfont icon-weibiaoti1"})])]),e._v(" "),t("div",{staticClass:"userId"}),e._v(" "),t("div",{staticClass:"userName"},[t("div",{staticClass:"username-box"},[t("span",[e._v("昵称：")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.nickname,expression:"nickname"}],attrs:{type:"text",placeholder:"昵称"},domProps:{value:e.nickname},on:{input:function(s){s.target.composing||(e.nickname=s.target.value)}}}),e._v(" "),t("i",{staticClass:"iconfont icon-xiugaiziliao",on:{click:e.changeUsername}})])]),e._v(" "),t("div",{staticClass:"userName"},[t("div",{staticClass:"username-box"},[t("span",[e._v("签名：")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.signature,expression:"signature"}],attrs:{type:"text",placeholder:"写点什么吧..."},domProps:{value:e.signature},on:{input:function(s){s.target.composing||(e.signature=s.target.value)}}}),e._v(" "),t("i",{staticClass:"iconfont icon-xiugaiziliao",on:{click:e.changeSign}})])])]),e._v(" "),t("div",{staticClass:"interval"}),e._v(" "),t("div",{staticClass:"pageContent"},[t("div",{staticClass:"password"},[t("div",{staticClass:"psdTitle"},[e._v("登录密码修改")]),e._v(" "),t("div",{staticClass:"original-psd"},[t("mt-field",{attrs:{type:"password",placeholder:"请输入原始密码",autocomplete:"off"},model:{value:e.originalPsd,callback:function(s){e.originalPsd=s},expression:"originalPsd"}})],1),e._v(" "),t("div",{staticClass:"psdError",class:{psdErrorActive:e.oriActive}},[e._v("*密码不正确")]),e._v(" "),t("div",{staticClass:"new-psd1"},[t("mt-field",{attrs:{type:"password",placeholder:"请输入新密码"},model:{value:e.newPsd1,callback:function(s){e.newPsd1=s},expression:"newPsd1"}})],1),e._v(" "),t("div",{staticClass:"psdError"}),e._v(" "),t("div",{staticClass:"new-psd2"},[t("mt-field",{attrs:{type:"password",placeholder:"请确认新密码"},model:{value:e.newPsd2,callback:function(s){e.newPsd2=s},expression:"newPsd2"}})],1),e._v(" "),t("div",{staticClass:"psdError",class:{psdErrorActive:e.newActive}},[e._v("*新密码不一致请再次输入")]),e._v(" "),t("mt-button",{staticClass:"psdBtn",attrs:{size:"large"},on:{click:e.psdVerify}},[e._v("确定修改")])],1)])],1)},staticRenderFns:[]};var r=t("VU/8")(n,o,!1,function(e){t("sJ2d")},"data-v-350e2062",null);s.default=r.exports},sJ2d:function(e,s){}});
//# sourceMappingURL=41.49ea7dcbb6ffcd2f55fd.js.map